{"version":3,"sources":["../src/index.tsx","../src/components/MapRenderer.tsx","../src/components/GameRenderer.tsx"],"sourcesContent":["import { render } from 'ink';\nimport type { Map as GameMap, World, Position } from '@atsu/choukai';\nimport { MapRenderer } from './components/MapRenderer';\nimport { GameRenderer } from './components/GameRenderer';\n\nexport { MapRenderer, GameRenderer };\n\ninterface IUnitPosition {\n  unitId: string;\n  mapId: string;\n  position: Position;\n}\n\n// Convenience function to render a single map\nexport const renderMap = (\n  map: GameMap,\n  unitNames?: Record<string, string>,\n  options?: {\n    showCoordinates?: boolean;\n    cellWidth?: number;\n    showUnits?: boolean;\n    showTerrain?: boolean;\n    compactView?: boolean;\n    useColors?: boolean;\n  }\n) => {\n  const { waitUntilExit } = render(\n    <MapRenderer\n      map={map}\n      unitNames={unitNames}\n      {...options}\n    />\n  );\n  \n  return waitUntilExit;\n};\n\n// Convenience function to render the entire game world\nexport const renderGame = (\n  world: World,\n  unitNames?: Record<string, string>,\n  unitPositions?: Record<string, IUnitPosition>,\n  selectedMap?: string\n) => {\n  const { waitUntilExit } = render(\n    <GameRenderer\n      world={world}\n      unitNames={unitNames}\n      unitPositions={unitPositions}\n      selectedMap={selectedMap}\n    />\n  );\n  \n  return waitUntilExit;\n};","import React, { useEffect, useState } from 'react';\nimport { Box, Text, Newline } from 'ink';\nimport type { Map as GameMap, Position } from '@atsu/choukai';\n\ninterface MapRendererProps {\n  map: GameMap;\n  unitNames?: Record<string, string>;\n  unitPositions?: Record<string, { mapId: string; position: Position }>;\n  showCoordinates?: boolean;\n  cellWidth?: number;\n  showUnits?: boolean;\n  showTerrain?: boolean;\n  compactView?: boolean;\n  useColors?: boolean;\n}\n\nconst TERRAIN_SYMBOLS: Record<string, string> = {\n  grass: '.',\n  water: '~',\n  mountain: '^',\n  forest: 't',\n  desert: '#',\n  road: '=',\n  plains: '.',\n  swamp: ':',\n  snow: '*',\n  sand: '-',\n};\n\nconst TERRAIN_COLORS: Record<string, string> = {\n  grass: 'gray',\n  water: 'blue',\n  mountain: 'white',\n  forest: 'green',\n  desert: 'yellow',\n  road: 'gray',\n  plains: 'cyan',\n  swamp: 'magenta',\n  snow: 'white',\n  sand: 'yellow',\n};\n\nconst UNIT_COLOR = 'green';\n\nexport const MapRenderer: React.FC<MapRendererProps> = ({\n  map,\n  unitNames = {},\n  showCoordinates = true,\n  cellWidth = 1,\n  showUnits = true,\n  showTerrain = true,\n  compactView = true,\n  useColors = true,\n}) => {\n  const [mapState, setMapState] = useState<{content: string, isUnit: boolean, terrain: string}[][]>([]);\n\n  useEffect(() => {\n    const updatedMap: {content: string, isUnit: boolean, terrain: string}[][] = [];\n\n    // Generate the map display\n    for (let y = 0; y < map.height; y++) {\n      const row: {content: string, isUnit: boolean, terrain: string}[] = [];\n\n      if (showCoordinates) {\n        const coordStr = y.toString().padStart(2, ' ');\n        row.push({ content: compactView ? `${coordStr}|` : `${coordStr} |`, isUnit: false, terrain: 'grass' });\n      }\n\n      for (let x = 0; x < map.width; x++) {\n        let cellContent = '';\n        let isUnit = false;\n        let terrainType = 'grass';\n\n        if (showUnits) {\n          const unitId = map.getUnitAt(x, y);\n          if (unitId) {\n            const unitName = unitNames[unitId] || unitId;\n            cellContent = unitName.charAt(0).toUpperCase();\n            isUnit = true;\n          }\n        }\n\n        if (!cellContent && showTerrain) {\n          const cell = map.getCell(x, y);\n          terrainType = cell?.terrain || 'grass';\n          cellContent = TERRAIN_SYMBOLS[terrainType] || '?';\n        }\n\n        // Pad the cell content to the desired width\n        if (cellWidth > 1) {\n          cellContent = cellContent.padEnd(cellWidth, ' ');\n        } else if (!compactView) {\n          cellContent += ' ';\n        }\n\n        row.push({ content: cellContent, isUnit, terrain: terrainType });\n      }\n\n      updatedMap.push(row);\n    }\n\n    setMapState(updatedMap);\n  }, [map, unitNames, showCoordinates, cellWidth, showUnits, showTerrain, compactView]);\n\n  return (\n    <Box flexDirection=\"column\">\n      <Text bold>{`Map: ${map.name} (${map.width}x${map.height})`}</Text>\n      <Newline />\n      {mapState.map((row, rowIndex) => (\n        <Box key={rowIndex} flexDirection=\"row\">\n          {row.map((cellData, cellIndex) => {\n            const color = useColors\n              ? (cellData.isUnit ? UNIT_COLOR : TERRAIN_COLORS[cellData.terrain])\n              : undefined;\n\n            return (\n              <Text key={cellIndex} color={color}>\n                {cellData.content}\n              </Text>\n            );\n          })}\n        </Box>\n      ))}\n    </Box>\n  );\n};","import React from 'react';\nimport { Box, Text, Newline } from 'ink';\nimport type { Map as GameMap, World, Position } from '@atsu/choukai';\nimport { MapRenderer } from './MapRenderer';\n\ninterface IUnitPosition {\n  unitId: string;\n  mapId: string;\n  position: Position;\n}\n\ninterface GameRendererProps {\n  world: World;\n  unitNames?: Record<string, string>;\n  unitPositions?: Record<string, IUnitPosition>;\n  selectedMap?: string;\n}\n\nexport const GameRenderer: React.FC<GameRendererProps> = ({\n  world,\n  unitNames = {},\n  unitPositions = {},\n  selectedMap,\n}) => {\n  const maps = world.getAllMaps();\n  const mapsToRender = selectedMap \n    ? maps.filter(map => map.name === selectedMap)\n    : maps;\n\n  // Create unit mapping for each map\n  const createUnitMap = (map: GameMap): Record<string, string> => {\n    const mapUnits: Record<string, string> = {};\n    \n    Object.entries(unitNames).forEach(([unitId, name]) => {\n      const pos = unitPositions[unitId];\n      if (pos && pos.mapId === map.name) {\n        mapUnits[unitId] = name;\n      }\n    });\n    \n    return mapUnits;\n  };\n\n  return (\n    <Box flexDirection=\"column\" padding={1}>\n      <Box flexDirection=\"row\" justifyContent=\"space-between\" marginBottom={1}>\n        <Text bold color=\"cyan\">Takao Engine - Game View</Text>\n        <Text color=\"gray\">{new Date().toLocaleTimeString()}</Text>\n      </Box>\n      \n      {mapsToRender.length === 0 ? (\n        <Text color=\"yellow\">No maps available</Text>\n      ) : (\n        mapsToRender.map((map, index) => (\n          <Box key={map.name} flexDirection=\"column\" marginBottom={2}>\n            <MapRenderer\n              map={map}\n              unitNames={createUnitMap(map)}\n              showCoordinates={true}\n              cellWidth={1}\n              showUnits={true}\n              showTerrain={true}\n              compactView={true}\n              useColors={true}\n            />\n            \n            {index < mapsToRender.length - 1 && <Newline />}\n          </Box>\n        ))\n      )}\n      \n      {/* Unit positions summary */}\n      {Object.keys(unitPositions).length > 0 && (\n        <Box flexDirection=\"column\" marginTop={1}>\n          <Text bold>Unit Positions:</Text>\n          {Object.entries(unitPositions).map(([unitId, posInfo]) => {\n            const unitName = unitNames[unitId] || unitId;\n            return (\n              <Text key={unitId}>\n                {unitName} ({unitId.substring(0, 8)}...) at {posInfo.mapId} ({posInfo.position.x}, {posInfo.position.y})\n              </Text>\n            );\n          })}\n        </Box>\n      )}\n    </Box>\n  );\n};"],"mappings":"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","names":["import_ink","import_ink","import_jsx_runtime","import_jsx_runtime"]}